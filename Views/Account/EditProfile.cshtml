@model DoAnChuyenNganh.Models.ViewModels.EditProfileViewModel
@{
    ViewData["Title"] = "Chỉnh sửa thông tin cá nhân";
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet" />

<style>
    :root {
        --coral: #ff6b6b;
        --coral-dark: #ee5a5a;
        --bg-card: #fff;
    }

    .text-coral {
        color: var(--coral);
    }

    .btn-coral {
        background-color: var(--coral);
        color: #fff;
        border-radius: .5rem;
        transition: all 0.3s ease;
    }

        .btn-coral:hover {
            background-color: var(--coral-dark);
            transform: translateY(-2px);
        }

    .card-profile {
        background-color: var(--bg-card);
        border-radius: 1rem;
        box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15);
        transition: all 0.3s ease;
    }

        .card-profile:hover {
            transform: translateY(-5px);
            box-shadow: 0 1rem 2rem rgba(0,0,0,0.2);
        }

    .input-group .btn {
        border-radius: 0 .5rem .5rem 0;
    }
</style>

<div class="container my-5">
    <div class="card card-profile p-4 animate__animated animate__fadeIn">
        <h3 class="text-center text-coral mb-4 fw-bold"><i class="bi bi-person-circle me-2"></i>@ViewData["Title"]</h3>

        @if (ViewBag.Message != null)
        {
            <div class="alert alert-success text-center animate__animated animate__fadeIn">@Html.Raw(ViewBag.Message)</div>
        }
        @if (ViewBag.PasswordMessage != null)
        {
            <div class="alert alert-success text-center animate__animated animate__fadeIn">@Html.Raw(ViewBag.PasswordMessage)</div>
        }
        @if (ViewBag.PasswordError != null)
        {
            <div class="alert alert-danger text-center animate__animated animate__shakeX">@Html.Raw(ViewBag.PasswordError)</div>
        }

        <form asp-action="EditProfile" method="post">
            <div asp-validation-summary="All" class="text-danger mb-3"></div>

            <div class="row g-3 mb-3">
                <div class="col-md-6">
                    <label asp-for="FullName" class="form-label fw-semibold"></label>
                    <input asp-for="FullName" class="form-control" placeholder="Nhập họ tên" />
                    <span asp-validation-for="FullName" class="text-danger"></span>
                </div>
                <div class="col-md-6">
                    <label asp-for="Address" class="form-label fw-semibold"></label>
                    <input asp-for="Address" class="form-control" placeholder="Nhập địa chỉ" />
                    <span asp-validation-for="Address" class="text-danger"></span>
                </div>
            </div>

            <div class="row g-3 mb-4">
                <div class="col-md-6">
                    <label asp-for="DateOfBirth" class="form-label fw-semibold"></label>
                    <input asp-for="DateOfBirth" type="date" class="form-control" />
                    <span asp-validation-for="DateOfBirth" class="text-danger"></span>
                </div>
                <div class="col-md-6">
                    <label asp-for="PhoneNumber" class="form-label fw-semibold"></label>
                    <input asp-for="PhoneNumber" type="tel" class="form-control" placeholder="Nhập số điện thoại" />
                    <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                </div>
            </div>

            <hr />
            <h5 class="text-coral fw-semibold mb-3">🔒 Đổi mật khẩu (tùy chọn)</h5>
            <div class="row g-3 mb-4">
                <div class="col-md-4">
                    <label asp-for="OldPassword" class="form-label fw-semibold"></label>
                    <div class="input-group">
                        <input asp-for="OldPassword" type="password" id="oldPassword" class="form-control" placeholder="Mật khẩu cũ" />
                        <button type="button" class="btn btn-outline-secondary" onclick="togglePassword('oldPassword','oldToggleIcon')">
                            <i id="oldToggleIcon" class="bi bi-eye-fill"></i>
                        </button>
                    </div>
                </div>
                <div class="col-md-4">
                    <label asp-for="NewPassword" class="form-label fw-semibold"></label>
                    <div class="input-group">
                        <input asp-for="NewPassword" type="password" id="newPassword" class="form-control" placeholder="Mật khẩu mới" />
                        <button type="button" class="btn btn-outline-secondary" onclick="togglePassword('newPassword','newToggleIcon')">
                            <i id="newToggleIcon" class="bi bi-eye-fill"></i>
                        </button>
                    </div>
                </div>
                <div class="col-md-4">
                    <label asp-for="ConfirmPassword" class="form-label fw-semibold"></label>
                    <div class="input-group">
                        <input asp-for="ConfirmPassword" type="password" id="confirmPassword" class="form-control" placeholder="Nhập lại mật khẩu" />
                        <button type="button" class="btn btn-outline-secondary" onclick="togglePassword('confirmPassword','confirmToggleIcon')">
                            <i id="confirmToggleIcon" class="bi bi-eye-fill"></i>
                        </button>
                    </div>
                </div>
            </div>

            <button type="submit" class="btn btn-coral w-100 py-2 fw-semibold mb-2">💾 Lưu thay đổi</button>
        </form>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        function togglePassword(inputId, iconId) {
            const input = document.getElementById(inputId);
            const icon = document.getElementById(iconId);
            if (input.type === "password") {
                input.type = "text";
                icon.classList.replace("bi-eye-fill","bi-eye-slash-fill");
            } else {
                input.type = "password";
                icon.classList.replace("bi-eye-slash-fill","bi-eye-fill");
            }
        }
        @if (ViewBag.Message != null || ViewBag.PasswordMessage != null)
        {
                <text>
                Swal.fire({ icon: 'success', title: 'Thành công!', text: '@Html.Raw(ViewBag.Message ?? ViewBag.PasswordMessage)', timer: 2000, showConfirmButton: false, timerProgressBar: true });
                </text>
        }
    </script>
}
