@model DoAnChuyenNganh.Models.Restaurant

@{
    ViewData["Title"] = "Đặt món tại " + Model.Name;
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet" />

<div class="container mt-4">
    <h2 class="mb-4 text-center text-primary">
        <i class="bi bi-basket2-fill me-2"></i>@ViewData["Title"]
    </h2>

    <form asp-action="CreateOrder" method="post">
        @Html.AntiForgeryToken()
        <input type="hidden" name="restaurantId" value="@Model.Id" />

        <div class="row g-4">
            @foreach (var menuItem in Model.MenuItems)
            {
                <div class="col-md-4">
                    <div class="card h-100 shadow-sm">
                        <!-- 🖼️ Hình ảnh món -->
                        <img src="@(string.IsNullOrEmpty(menuItem.ImageUrl)
                                                         ? "/images/no-image.png"
                                                         : menuItem.ImageUrl)"
                             class="card-img-top"
                             style="height:200px; object-fit:cover;" />

                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">@menuItem.Name</h5>

                            <p class="card-text text-muted small">
                                @menuItem.Description
                            </p>

                            <div class="mt-auto">
                                <p class="fw-bold text-danger fs-5">
                                    @menuItem.Price.ToString("N0") đ
                                </p>

                                <input type="hidden" name="menuItemIds" value="@menuItem.Id" />

                                <!-- NÚT + / − -->
                                <div class="input-group mb-2">
                                    <button type="button" class="btn btn-outline-secondary btn-decrease">−</button>
                                    <input type="number"
                                           name="quantities"
                                           value="0"
                                           min="0"
                                           class="form-control text-center quantity-input" />
                                    <button type="button" class="btn btn-outline-secondary btn-increase">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>

        <div class="text-center mt-4">
            <button type="submit" class="btn btn-lg btn-success px-5">
                <i class="bi bi-cart-check me-2"></i>Đặt hàng
            </button>
        </div>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // 🔹 NÚT + / −
    document.querySelectorAll(".btn-increase").forEach(btn => {
        btn.addEventListener("click", e => {
            const input = e.target.closest(".input-group").querySelector(".quantity-input");
            input.value = parseInt(input.value || "0") + 1;
        });
    });

    document.querySelectorAll(".btn-decrease").forEach(btn => {
        btn.addEventListener("click", e => {
            const input = e.target.closest(".input-group").querySelector(".quantity-input");
            let val = parseInt(input.value || "0") - 1;
            if (val < 0) val = 0;
            input.value = val;
        });
    });
</script>
